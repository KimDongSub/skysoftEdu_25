<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="TestSQL">

    <typeAlias alias="testVO" type="egovframework.dev.test.vo.TestVO"/>

    <!-- typeAlias :: Start! -->
    <resultMap id="TestMap"        class="testVO">
        <result property="seq"     column="SEQ" />
        <result property="title"   column="TITLE" />
        <result property="contents"   column="CONTENTS" />
        <result property="regDtm"   column="REG_DTM" javaType="date" jdbcType="DATE"/>
    </resultMap>
    <!-- typeAlias :: End! -->

    <!-- typeAlias :: Start! -->
    <resultMap id="TestListMap"        class="testVO">
        <result property="seq"     column="SEQ" />
        <result property="title"   column="TITLE" />
        <result property="regDtm"   column="REG_DTM" javaType="date" jdbcType="DATE"/>
          <result property="ttcnt"   column="TTCNT" />
    </resultMap>
    <!-- typeAlias :: End! -->

     <!-- typeAlias :: Start! -->
    <resultMap id="selectTCMap"        class="testVO">
        <result property="seq"     column="SEQ" />
        <result property="title"   column="TITLE" />
        <result property="regDtm"   column="REG_DTM" javaType="date" jdbcType="DATE"/>
        <result property="ttcnt"   column="TTCNT" />
    </resultMap>
    <!-- typeAlias :: End! -->

    <!-- typeAlias :: Start! -->
    <resultMap id="selectTMap"        class="testVO">
        <result property="seq"     column="SEQ" />
        <result property="title"   column="TITLE" />
        <result property="regDtm"   column="REG_DTM" javaType="date" jdbcType="DATE"/>
        <result property="ttcnt"   column="TTCNT" />
    </resultMap>
    <!-- typeAlias :: End! -->

    <!-- typeAlias :: Start! -->
    <resultMap id="selectCMap"        class="testVO">
        <result property="seq"     column="SEQ" />
        <result property="title"   column="TITLE" />
        <result property="regDtm"   column="REG_DTM" javaType="date" jdbcType="DATE"/>
        <result property="ttcnt"   column="TTCNT" />
    </resultMap>
    <!-- typeAlias :: End! -->

    <!-- C -->
    <insert id="testDAO.insertTest" parameterClass="testVO">
       INSERT INTO
                   TB_SKY_TEST
            VALUES (
                      SEQ_SKY_TEST.NEXTVAL,
                      #title#,
                      #contents#,
                      SYSDATE
                   )
    </insert>

    <!-- R -->
    <select id="testDAO.selectTestPk" parameterClass="testVO" resultMap="TestMap">
        SELECT SEQ,
               TITLE,
               CONTENTS,
               REG_DTM
          FROM TB_SKY_TEST
         WHERE SEQ=#seq#
    </select>

    <!-- U -->
    <update id="testDAO.updateTest" parameterClass="testVO">
        UPDATE TB_SKY_TEST
           SET TITLE=#title#,
               CONTENTS=#contents#,
               REG_DTM=SYSDATE
         WHERE SEQ=#seq#
    </update>

    <!-- D -->
    <delete id="testDAO.deleteTest" parameterClass="testVO">
        DELETE TB_SKY_TEST
         WHERE SEQ=#seq#
    </delete>

    <!-- L -->
    <select id="testDAO.selectTestList" parameterClass="testVO" resultMap="TestListMap">
    <![CDATA[
        SELECT SEQ,
               TITLE,
               REG_DTM,
               RN,
               TTCNT
          FROM (
                 SELECT T1.*,
                        COUNT(*) OVER() TTCNT,
                        ROWNUM AS RN
                   FROM (
                          SELECT SEQ,
                                 TITLE,
                                 REG_DTM
                            FROM TB_SKY_TEST
                        ORDER BY REG_DTM
                            DESC
                        )T1
               )
          WHERE RN
        BETWEEN #firstIndex#
            AND #lastIndex#
    ]]>
    </select>

    <!-- TCsearchL -->
    <select id="testDAO.selectTCList" parameterClass="testVO" resultMap="selectTCMap">
    <![CDATA[
        SELECT SEQ,
               TITLE,
               REG_DTM,
               TTCNT
          FROM (
                 SELECT T1.*,
                        COUNT(*) OVER() TTCNT,
                        ROWNUM AS RN
                   FROM (
                          SELECT SEQ,
                                 TITLE,
                                 REG_DTM
                            FROM TB_SKY_TEST
                           WHERE TITLE LIKE '%'||#title#||'%' AND CONTENTS LIKE '%'||#contents#||'%'
                        ORDER BY REG_DTM
                            DESC
                        )T1
               )
          WHERE RN
        BETWEEN #firstIndex#
            AND #lastIndex#
    ]]>
    </select>

	<!-- TsearchL -->
    <select id="testDAO.selectTList" parameterClass="testVO" resultMap="selectTMap">
    <![CDATA[
        SELECT SEQ,
               TITLE,
               REG_DTM,
               TTCNT
          FROM (
                 SELECT T1.*,
                        COUNT(*) OVER() TTCNT,
                        ROWNUM AS RN
                   FROM (
                          SELECT SEQ,
                                 TITLE,
                                 REG_DTM
                            FROM TB_SKY_TEST
                           WHERE TITLE LIKE '%'||#title#||'%'
                        ORDER BY REG_DTM
                            DESC
                        )T1
               )
          WHERE RN
        BETWEEN #firstIndex#
            AND #lastIndex#
    ]]>
    </select>

    <!-- CsearchL -->
    <select id="testDAO.selectCList" parameterClass="testVO" resultMap="selectCMap">
    <![CDATA[
        SELECT SEQ,
               TITLE,
               REG_DTM,
               TTCNT
          FROM (
                 SELECT T1.*,
                        COUNT(*) OVER() TTCNT,
                        ROWNUM AS RN
                   FROM (
                          SELECT SEQ,
                                 TITLE,
                                 REG_DTM
                            FROM TB_SKY_TEST
                           WHERE CONTENTS LIKE #contents#||'%'
                        ORDER BY REG_DTM
                            DESC
                        )T1
               )
          WHERE RN
        BETWEEN #firstIndex#
            AND #lastIndex#
    ]]>
    </select>

</sqlMap>
